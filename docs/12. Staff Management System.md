# **12\. Staff Management System**

### **12.1 Staff Management Features**

#### **Staff Onboarding**

interface OnboardingProcess {  
  steps: \[  
    {  
      id: 1,  
      name: 'Personal Information',  
      fields: \['name', 'phone', 'email', 'address', 'nationalId'\],  
      status: 'completed'  
    },  
    {  
      id: 2,  
      name: 'Employment Details',  
      fields: \['role', 'startDate', 'employmentType'\],  
      status: 'completed'  
    },  
    {  
      id: 3,  
      name: 'Skills & Certifications',  
      fields: \['skills', 'certifications'\],  
      status: 'in\_progress'  
    },  
    {  
      id: 4,  
      name: 'Availability Setup',  
      fields: \['workDays', 'preferredShifts', 'maxHoursPerWeek'\],  
      status: 'pending'  
    },  
    {  
      id: 5,  
      name: 'Training & Orientation',  
      fields: \['trainingCompleted', 'orientationDate'\],  
      status: 'pending'  
    }  
  \];  
}

#### **Staff Scheduling Interface**

interface SchedulingView {  
  type: 'week' | 'month';  
  displayMode: 'staff' | 'time\_slots';  
    
  // Staff view: Rows \= Staff, Columns \= Days  
  // Time slots view: Rows \= Time slots, Columns \= Days  
    
  features: {  
    dragAndDropAssignment: boolean;    // Drag booking to staff  
    conflictDetection: boolean;        // Highlight conflicts  
    travelTimeCalculation: boolean;    // Show travel time between jobs  
    workloadIndicators: boolean;       // Visual workload bars  
    filterBySkills: boolean;           // Show only staff with required skills  
    filterByAvailability: boolean;     // Show only available staff  
  };  
}

#### **Smart Assignment Algorithm**

interface AssignmentCriteria {  
  // Matching factors (weighted)  
  skillMatch: number;              // 40% \- Primary skills match  
  availability: number;            // 30% \- Available at time  
  location: number;                // 15% \- Proximity to job  
  performance: number;             // 10% \- Past performance  
  workload: number;                // 5% \- Current workload balance  
    
  // Hard constraints (must meet)  
  mustHaveSkills: string\[\];        // Required skills  
  mustBeAvailable: boolean;        // Must have no conflicts  
  maxDailyJobs: number;            // Cannot exceed limit  
    
  // Soft preferences  
  preferredStaff?: string;         // Customer preference  
  avoidStaff?: string\[\];           // Previous issues  
}

function calculateMatchScore(  
  staff: StaffMember,  
  booking: Booking,  
  criteria: AssignmentCriteria  
): number {  
  let score \= 0;  
    
  // Skill matching  
  const requiredSkills \= booking.service.requiredSkills;  
  const matchedSkills \= requiredSkills.filter(skill \=\>  
    staff.skills.primary.includes(skill) ||  
    staff.skills.secondary.includes(skill)  
  );  
  score \+= (matchedSkills.length / requiredSkills.length) \* 40;  
    
  // Availability (check schedule)  
  const isAvailable \= checkAvailability(staff.id, booking.schedule);  
  score \+= isAvailable ? 30 : 0;  
    
  // Location proximity  
  const distance \= calculateDistance(  
    staff.lastLocation,  
    booking.location  
  );  
  const locationScore \= Math.max(0, 15 \- (distance / 5)); // Lose 1 point per 5km  
  score \+= locationScore;  
    
  // Performance  
  score \+= (staff.performance.averageRating / 5\) \* 10;  
    
  // Workload balance  
  const currentJobs \= getCurrentDayJobs(staff.id, booking.schedule.date);  
  const workloadScore \= Math.max(0, 5 \- currentJobs);  
  score \+= workloadScore;  
    
  return score;  
}

#### **Performance Tracking**

interface PerformanceMetrics {  
  // Quantitative metrics  
  jobsCompleted: number;  
  jobsCancelled: number;  
  completionRate: number;          // %  
    
  // Quality metrics  
  averageRating: number;           // 0-5 from customers  
  customerSatisfaction: number;    // % satisfied  
  repeatCustomerRate: number;      // % of repeat requests  
    
  // Efficiency metrics  
  punctualityScore: number;        // % on-time arrivals  
  averageJobTime: number;          // minutes  
  overtimeFrequency: number;       // % jobs over estimated time  
    
  // Behavioral metrics  
  communicationScore: number;      // Admin rating  
  professionalismScore: number;    // Admin rating  
  issueCount: number;              // Number of reported issues  
    
  // Financial metrics  
  revenueGenerated: number;        // THB  
  costPerJob: number;              // THB (if applicable)  
}

interface PerformanceReview {  
  staffId: string;  
  reviewDate: Timestamp;  
  reviewPeriod: {  
    startDate: string;  
    endDate: string;  
  };  
    
  metrics: PerformanceMetrics;  
    
  strengths: string\[\];  
  areasForImprovement: string\[\];  
  goals: Array\<{  
    description: string;  
    target: string;  
    deadline: string;  
  }\>;  
    
  actionPlan: string;  
  nextReviewDate: Timestamp;  
    
  reviewedBy: string;              // Admin user ID  
  staffSignature?: string;         // Acknowledgment  
}

#### **Leave Management**

interface LeaveManagement {  
  // Leave types  
  types: {  
    annual: {  
      entitlement: number;         // Days per year  
      carryOver: boolean;          // Can carry to next year?  
      maxCarryOver: number;        // Max days to carry over  
    };  
    sick: {  
      entitlement: number;  
      requiresCertificate: boolean; // Medical cert required  
      certificateThreshold: number; // Days before cert required  
    };  
    personal: {  
      entitlement: number;  
      advanceNotice: number;       // Days of advance notice  
    };  
    emergency: {  
      approved: 'auto' | 'manual';  
      notificationRequired: boolean;  
    };  
  };  
    
  // Approval workflow  
  workflow: {  
    autoApprove: boolean;          // Auto-approve if no conflicts  
    requiresApproval: string\[\];    // User roles who can approve  
    escalationPath: string\[\];      // Escalate if not approved in X hours  
  };  
    
  // Blackout periods  
  blackoutPeriods: Array\<{  
    startDate: string;  
    endDate: string;  
    reason: string;                // e.g., "Peak season"  
    allowEmergency: boolean;  
  }\>;  
}

async function handleLeaveRequest(  
  staffId: string,  
  leaveRequest: LeaveRequest  
): Promise\<LeaveRequestResult\> {  
  // 1\. Check leave balance  
  const balance \= await getLeaveBalance(staffId, leaveRequest.type);  
  if (balance \< calculateLeaveDays(leaveRequest)) {  
    return {  
      status: 'rejected',  
      reason: 'Insufficient leave balance'  
    };  
  }  
    
  // 2\. Check blackout periods  
  if (isInBlackoutPeriod(leaveRequest.startDate, leaveRequest.endDate)) {  
    return {  
      status: 'rejected',  
      reason: 'Requested dates fall in blackout period'  
    };  
  }  
    
  // 3\. Check affected bookings  
  const affectedBookings \= await findAffectedBookings(  
    staffId,  
    leaveRequest.startDate,  
    leaveRequest.endDate  
  );  
    
  // 4\. Auto-approve if no conflicts and policy allows  
  if (affectedBookings.length \=== 0 && leaveManagement.workflow.autoApprove) {  
    await approveLeave(staffId, leaveRequest);  
    return {  
      status: 'approved',  
      affectedBookings: \[\]  
    };  
  }  
    
  // 5\. Require manual approval  
  await sendLeaveApprovalRequest(staffId, leaveRequest, affectedBookings);  
  return {  
    status: 'pending',  
    affectedBookings: affectedBookings  
  };  
}

### **12.2 Staff Portal (Mobile-Optimized)**

interface StaffPortalFeatures {  
  // Dashboard  
  dashboard: {  
    todaySchedule: Booking\[\];  
    upcomingJobs: Booking\[\];  
    recentActivity: Activity\[\];  
    performanceSnapshot: {  
      rating: number;  
      jobsThisMonth: number;  
      onTimeRate: number;  
    };  
  };  
    
  // Schedule view  
  schedule: {  
    viewMode: 'day' | 'week' | 'month';  
    showBookingDetails: boolean;  
    showDirections: boolean;       // Google Maps link  
    allowStatusUpdate: boolean;  
  };  
    
  // Job management  
  jobs: {  
    acceptDeclineBooking: boolean;  
    updateStatus: boolean;         // Start, Complete, Issue  
    addNotes: boolean;  
    uploadPhotos: boolean;         // Before/after photos  
    requestCustomerSignature: boolean;  
  };  
    
  // Availability management  
  availability: {  
    updateWorkDays: boolean;  
    blockTimeSlots: boolean;       // Temporary unavailability  
    requestLeave: boolean;  
  };  
    
  // Performance & feedback  
  performance: {  
    viewOwnMetrics: boolean;  
    viewCustomerFeedback: boolean;  
    viewGoals: boolean;  
  };  
    
  // Communication  
  communication: {  
    chatWithAdmin: boolean;  
    receiveNotifications: boolean;  
    emergencyContact: boolean;  
  };  
}

### **12.3 Team Management**

interface TeamManagement {  
  // Team structure  
  createTeam: (data: {  
    name: string;  
    description: string;  
    memberIds: string\[\];  
    leadId: string;  
    specialization: string\[\];  
  }) \=\> Promise\<Team\>;  
    
  // Team assignment  
  assignTeamToBooking: (teamId: string, bookingId: string) \=\> Promise\<void\>;  
    
  // Team performance  
  getTeamPerformance: (teamId: string, period: DateRange) \=\> Promise\<{  
    jobsCompleted: number;  
    averageRating: number;  
    memberUtilization: Array\<{  
      staffId: string;  
      utilization: number;  
    }\>;  
  }\>;  
    
  // Team scheduling  
  scheduleTeam: (teamId: string, booking: Booking) \=\> Promise\<{  
    conflicts: Array\<{  
      staffId: string;  
      reason: string;  
    }\>;  
    suggestions: Array\<{  
      alternativeMember: string;  
      reason: string;  
    }\>;  
  }\>;  
}  
